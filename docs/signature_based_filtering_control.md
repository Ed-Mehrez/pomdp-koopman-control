# Signature-Based Control for Partially Observed Stochastic Systems: Theory and Application

**Abstract**: This document establishes the theoretical justification for using Path Signatures as a feature basis for controlling stochastic systems with hidden states. We define a general class of **Latent Bilinear Stochastic Control Systems** and show that the Signature of the observation path serves as a universal non-linear filter for the hidden state. We then specialize this theory to the **Heston Model**, demonstrating that the "roughness" terms in the Signature provide a direct proxy for the unobserved volatility, enabling effective feedback control without explicit state estimation.

------------------------------------------------------------------------

## 1. General Framework: Latent Bilinear Control Systems

We consider a class of continuous-time stochastic control systems where the state space $\mathcal{X}$ is partitioned into an **observed component** $Y_t \in \mathbb{R}^{d_y}$ and a **hidden component** $Z_t \in \mathbb{R}^{d_z}$.

### 1.1 Dynamics

The system evolves according to a control-affine Itô SDE driven by a multidimensional Brownian motion $W_t$:

$$
\begin{aligned}
dZ_t &= \left( A_0 Z_t + \sum_{k=1}^m u^k_t A_k Z_t \right) dt + \sum_{j=1}^p \sigma_j(Z_t) dW^j_t \\
dY_t &= C(Z_t) dW^j_t
\end{aligned}
$$

**Key Assumptions**:

1.  **Bilinear Drift**: The control $u_t$ enters linearly and multiplies the state (bilinear), typically representing gains or rates.
2.  **Hidden Volatility Structure**: The observation $Y_t$ (e.g., asset price) is an integral of a noise process modulated by the hidden state $Z_t$ (e.g., volatility). The map $C: \mathcal{X} \to \mathbb{R}^{d_y \times p}$ couples the hidden state to the *roughness* of the observation.

### 1.2 The Filtering Problem

The control objective is to minimize a cost functional $J(u)$ given only the filtration $\mathcal{F}^Y_t$ generated by the observation path $Y_{[0,t]}$. This requires estimating the hidden state $Z_t$ (or the optimal control $u^*(Z_t)$) from the path history.

Standard approaches (e.g., Extended Kalman Filter, Particle Filters) impose strong parametric assumptions or high computational burdens. We propose a **Signature-based** approach.

------------------------------------------------------------------------

## 2. Theoretical Justification: Signatures as Universal Filters

The **Signature** of the observation path $Y$, denoted $S(Y)_{0,t} \in T((\mathbb{R}^{d_y}))$, is the sequence of all iterated integrals of $Y$.

### 2.1 The Universal Approximation Theorem for Filters

Recent results (Lyons, Ni, Oberhauser) establish that the Signature is a **universal feature set** for the conditional distribution of the hidden state.

> **Theorem (Signature Filtering)** Under hypoellipticity conditions, if the map from the hidden path to the observed path is continuous in the rough path topology, then the conditional expectation of any continuous function $f(Z_t)$ given the observation path $Y_{[0,t]}$ can be approximated arbitrarily well by a linear functional of the Signature of $Y$: $$ \mathbb{E}[f(Z_t) | \mathcal{F}^Y_t] \approx \langle \mathbf{w}, S(Y)\_{t-\delta, t} \rangle $$

**Implication for Control**: Instead of explicitly estimating $\hat{Z}_t$ and then computing $u(\hat{Z}_t)$ (Separation Principle), we can learn a direct policy map $\pi: T((\mathbb{R}^{d_y})) \to \mathbb{R}^m$: $$ u*t = K^\top \mathbf{\Psi}(S(Y)*{t-\delta, t}) $$ This policy implicitly performs the filtering and control simultaneously.

### 2.2 Capturing "Roughness" (Quadratic Variation)

The crucial link for stochastic systems is that the Signature encodes not just the *path* but its *variation*. For a stochastic process $Y_t$, the second-level terms of the signature contain the **Lévy Area** and the **Quadratic Variation**.

The symmetric part of the second iterated integral is: $$ \int_0^t Y^i_s dY^j_s + \int_0^t Y^j_s dY^i_s = Y^i_t Y^j_t - Y^i_0 Y^j_0 - \langle Y^i, Y^j \rangle_t $$ Thus, the **bracket** (quadratic variation) $\langle Y, Y \rangle_t$ is linearly recoverable from the Signature and the endpoints (level 1 terms).

If the observation is $dY_t = \sigma(Z_t) dW_t$, then: $$ d\langle Y, Y \rangle_t = \sigma(Z_t)^2 dt $$ Therefore, \*\*the Signature over a small window $[t-\delta, t]$ contains information about the integral of the squared volatility\*\*, effectively acting as a volatility estimator.

------------------------------------------------------------------------

## 3. Application: The Heston Model

We maps the Heston model to the general class defined above to justify the use of Signatures.

### 3.1 Heston as a Latent System

-   **Hidden State (**$Z_t$): The instantaneous variance $v_t$.
-   **Observation (**$Y_t$): The Log-Price $X_t = \log S_t$.
-   **Dynamics**: $$
    \begin{aligned}
    dX_t &= (r - \frac{1}{2}v_t) dt + \sqrt{v_t} dW^1_t \quad (\text{Observation}) \\
    dv_t &= \kappa(\theta - v_t) dt + \xi \sqrt{v_t} dW^2_t \quad (\text{Hidden})
    \end{aligned}
    $$

### 3.2 The Signature Link

Observation $X_t$ is driven by $\sqrt{v_t}$. The quadratic variation of the log-price is: $$ \langle X, X \rangle_t = \int_0^t v_s ds $$

Consider the standard Level-2 Signature term of the path $X$: $$ \mathbf{S}^{(2)}_{t-\delta, t} = \int_{t-\delta}^t (X*s - X*{t-\delta}) dX*s $$ By Itô calculus: $$ \int (X_s) dX_s = \frac{1}{2}(X_t^2 - X*{t-\delta}^2) - \frac{1}{2} \langle X, X \rangle*{t-\delta, t} $$ Rearranging, the integrated variance is: $$ \int*{t-\delta}^t v*s ds = (X_t - X*{t-\delta})^2 - 2 \mathbf{S}^{(2)}\_{t-\delta, t} + \text{First Order Terms} $$

### 3.3 Conclusion

The level-2 terms of the Log-Price signature provide a **linear readout of the average variance** over the window $[t-\delta, t]$. $$ \frac{1}{\delta} \int*{t-\delta}^t v_s ds \approx v_t $$ This mathematically guarantees that a controller taking $S(X)*{t-\delta, t}$ as input has access to the hidden variable $v_t$.

By augmenting the state with the Signature: $$ \Psi_t = [1, S(X)^1, S(X)^2, \dots] \in \mathbb{R}^K $$ We effectively "lift" the partially observed Heston system into a fully observed linear system on the Tensor Algebra (or a bilinear system on the Lie Algebra via Log-Signatures), allowing us to apply the Koopman/LQR methods developed in this project.
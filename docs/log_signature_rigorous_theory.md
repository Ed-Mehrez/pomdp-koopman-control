# Theory of Log-Signatures in Control: Geometric Redundancy and Intrinsic Coordinates

**Abstract**: This document provides a rigorous mathematical justification for the use of Log-Signatures as a feature basis in data-driven control. We formulate the control problem on the specific group of the shuffle algebra and show that the "Log-Signature" corresponds to the minimal intrinsic coordinates on the Lie Group associated with the control system's accessible manifold. We present formal Propositions and Proofs regarding the redundancy of the standard Signature and the sufficiency of the Log-Signature.

## 1. Algebraic Preliminaries

### 1.1 The Tensor Algebra and Signature

Let $V = \mathbb{R}^d$ be the control input space. Let $T((V))$ be the tensor algebra over $V$, which contains the formal power series of non-commutative tensors: $$ \mathbf{S} = (1, \mathbf{S}^1, \mathbf{S}^2, \dots) \in T((V)) $$

For a path $X: [0, T] \to V$, the **Signature** $S(X)_{0,T}$ is defined as the solution to the linear differential equation in $T((V))$: $$ d\mathbf{S}_t = \mathbf{S}_t \otimes dX_t, \quad \mathbf{S}_0 = 1 $$

Equivalently, it is the sequence of all iterated integrals: $$ S(X)_{0,T} = 1 + \sum_{k=1}^\infty \sum_{i_1, \dots, i_k} \left( \int_{0 < t_1 < \dots < t_k < T} dX^{i_1}_{t_1} \dots dX^{i_k}_{t_k} \right) e_{i_1} \otimes \dots \otimes e_{i_k} $$

### 1.2 The Shuffle Product and Redundancy

The set of coordinate iterated integrals forms a commutative algebra under the **shuffle product** $\amalg$.

> **Definition 1 (Shuffle Product)** For two words $u, v$ in the tensor algebra basis, the shuffle product $u \amalg v$ is the sum of all words formed by interleaving the letters of $u$ and $v$ while preserving their relative order.

> **Theorem 1 (Ree's Shuffle Identity)** For any path $X$, the product of two coordinate signatures satisfies: $$ \langle S(X), u \rangle \cdot \langle S(X), v \rangle = \langle S(X), u \amalg v \rangle $$ where $\langle \cdot, \cdot \rangle$ denotes the coefficient projection.

**Remark**: This theorem implies that the linear basis of the Signature contains "products of itself". Algebraically, the coordinates are not independent. Understanding the system dynamics using the full Signature is equivalent to regressing on a basis that includes all polynomial combinations of a smaller generating set. This is the source of the $O(d^k)$ "curse of dimensionality".

------------------------------------------------------------------------

## 2. Theoretical Core: The Log-Signature

### 2.1 The Free Lie Algebra

Let $\mathcal{L}(V)$ be the **Free Lie Algebra** generated by $V$. This is the subspace of $T((V))$ spanned by Lie brackets $[a, b] = a \otimes b - b \otimes a$. By the geometric nature of the Signature ODE, the solution $S(X)$ lies in the group of "grouplike elements". The logarithm of a grouplike element lies in the Lie algebra.

> **Definition 2 (Log-Signature)** The Log-Signature of a path $X$ is defined as: $$ L(X) := \log(S(X)) = \sum_{k=1}^\infty \frac{(-1)^{k-1}}{k} (S(X) - 1)^{\otimes k} $$ Importantly, $L(X) \in \mathcal{L}((V))$.

### 2.2 The Dimensionality Proposition

> **Proposition 1 (Minimal Generators)** The Log-Signature $L(X)$ provides a minimal set of coordinates that fully characterizes the path $X$ up to tree-like equivalence. The dimension of the degree-$m$ component of the Free Lie Algebra is given by **Witt's Formula**: $$ \dim(\mathcal{L}_m) = \frac{1}{m} \sum_{k|m} \mu(k) d^{m/k} $$ where $\mu$ is the Möbius function.

**Proof**: The enveloping algebra of the Free Lie Algebra is the Free Tensor Algebra. By the Poincaré-Birkhoff-Witt (PBW) theorem, a basis for the tensor algebra can be constructed from products of Lyondon words (the basis of the Lie algebra). Thus, the Tensor Algebra is isomorphic to the symmetric algebra over the Lie Algebra. This implies that any information contained in the Signature $S(X)$ can be reconstructed as a polynomial function of the Log-Signature $L(X)$. Therefore, a linear policy on $S(X)$ is equivalent to a polynomial policy on $L(X)$. Since we typically learn nonlinear (or high-dimensional linear) controllers, restricting to the generating set $L(X)$ removes algebraic redundancy without loss of information. $\hfill \blacksquare$

**Remark (Intuition)**: In a 2-dimensional system ($x, y$): - **Signature terms (Degree 2)**: $\int dx$, $\int dy$, $\int dx dy$, $\int dy dx$. (4 terms). - **Redundancy**: $\int dx \int dy = \int dx dy + \int dy dx$. - **Log-Signature terms**: $\int dx$, $\int dy$, $\frac{1}{2}(\int dx dy - \int dy dx)$. (3 terms). - The term $\int dx dy - \int dy dx$ is the **Lévy Area**, representing the Lie bracket $[e_x, e_y]$. This is the non-commutative "steering" effect. The symmetric part is just $(x \cdot y)$, which is determined completely by the endpoints.

------------------------------------------------------------------------

## 3. Connection to Control Theory

### 3.1 The Fliess Expansion

> **Conjecture 2 (Control on the Lie Algebra)** For a control-affine system $\dot{z} = \sum_{i} f_i(z) u^i_t$, the solution can be locally written as a **Fliess Series**: $$ y(t) = \sum_{w \in \text{Words}} c_w S(u)^w_{0,t} $$ where each coefficient $c_w$ is the directional derivative of the output along the vector fields specified by word $w$.
>
> We conjecture that for controllable systems, the relevant dynamics are driven solely by the **Lie brackets** of the vector fields $\{f_i\}$, and thus the input's influence is captured entirely by the **Log-Signature** coefficients corresponding to those brackets.

**Justification via Chen-Fliess-Sussmann**: The Chen-Fliess series makes explicit that the system response is a pairing between the iterated integrals of the input (Signature) and the iterated Lie derivatives of the vector fields. Since $S(X) = \exp(L(X))$, we can rewrite the Fliess series as: $$ y(t) = f\left( \exp \left( \sum_{\alpha} \lambda_\alpha(t) \text{Br}_\alpha \right) z_0 \right) $$ where $\text{Br}_\alpha$ are basis elements of the Lie Algebra of vector fields, and $\lambda_\alpha(t)$ are the Log-Signature components of the input. This form explicitly shows that the Log-Signature coordinates $\lambda_\alpha$ are the natural "control knobs" acting on the system's state manifold via the exponential map.

### 3.2 The Argument for "Lifted LQR" with Log-Signatures

In the KRONIC framework, we solve $u_t = -K z_t$ where $z_t$ is the feature state. If $z_t = S(X_t)$, we are solving for a linear feedback in the Tensor Algebra. $$ u \sim \sum a_{ij} \int dX^i \int dX^j $$ This includes redundant symmetric terms. If $z_t = L(X_t)$, we are solving: $$ u \sim \sum b_k \text{LieBracket}_k(X) $$ This restricts the feedback strictly to the **directions** in which the path is effectively curving or encompassing area. For high-frequency control ($dt \to 0$), the "area" terms (Lie brackets) scale as $dt^2$, $dt^3$, etc. These are the small, non-commutative corrections that stabilize the system. By isolating them in the Log-Signature, the LQR solver can specifically target these "steering" modes without being washed out by the larger, redundant first-order terms.

## 4. Conclusion

Replacing Signatures with Log-Signatures is defined by a projection $\pi: T((V)) \to \mathcal{L}((V))$. 1. **Algebraic Correctness**: The map is a homomorphism from the path group to the Lie algebra. 2. **Information Preservation**: A path (with monotonic time) is uniquely determined by its Log-Signature (Chen's Injectivity Theorem). 3. **Computational Efficiency**: The dimension reduction $O(d^k) \to O(k^{-1} d^k)$ provides a $\approx 3-10\times$ speedup for typical degrees, while improving numerical conditioning by removing collinear symmetric features.

Therefore, the switch to Log-Signatures is theoretically sound and practically advantageous for high-speed, data-driven control.